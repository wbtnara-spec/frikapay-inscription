document.addEventListener('DOMContentLoaded',function(){const form=document.getElementById('inscriptionForm');const typeSelect=document.getElementById('type_utilisateur');const secteurGroup=document.getElementById('secteur_group');const submitBtn=document.getElementById('submitBtn');const btnText=submitBtn.querySelector('.btn-text');const loader=submitBtn.querySelector('.loader');typeSelect.addEventListener('change',function(){if(this.value==='commercant'){secteurGroup.classList.add('show')}else{secteurGroup.classList.remove('show');document.getElementById('secteur_activite').value=''}});form.addEventListener('submit',async function(e){e.preventDefault();if(document.getElementById('website').value){console.log('Bot détecté');return}let isValid=true;const requiredFields=form.querySelectorAll('input[required], select[required], textarea[required]');requiredFields.forEach(field=>{const errorMsg=field.parentElement.querySelector('.error-message');if(!field.value.trim()){field.classList.add('error');if(errorMsg)errorMsg.classList.add('show');isValid=false}else{field.classList.remove('error');if(errorMsg)errorMsg.classList.remove('show')}});const email=document.getElementById('email').value;const emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;const emailError=document.getElementById('email').parentElement.querySelector('.error-message');if(email&&!emailRegex.test(email)){document.getElementById('email').classList.add('error');if(emailError){emailError.textContent='Veuillez entrer une adresse email valide';emailError.classList.add('show')}isValid=false}const phone=document.getElementById('telephone').value;const phoneRegex=/^[+]?[\d\s\-()]+$/;const phoneError=document.getElementById('telephone').parentElement.querySelector('.error-message');if(phone&&!phoneRegex.test(phone)){document.getElementById('telephone').classList.add('error');if(phoneError){phoneError.textContent='Veuillez entrer un numéro de téléphone valide';phoneError.classList.add('show')}isValid=false}const conditions=document.getElementById('conditions');const conditionsError=document.querySelector('.checkbox-group .error-message');if(!conditions.checked){conditionsError.classList.add('show');isValid=false}else{conditionsError.classList.remove('show')}if(!isValid){const firstError=form.querySelector('.error');if(firstError){firstError.scrollIntoView({behavior:'smooth',block:'center'})}return}submitBtn.disabled=true;submitBtn.classList.add('loading');const formData=new FormData(form);const data={};formData.forEach((value,key)=>{if(key!=='website'){data[key]=value}});try{const response=await fetch('https://script.google.com/macros/s/AKfycbx2OJdRz5YandfvM-R88dpwh8r6tiZ6yCZkB4wlsTWev4pmnOIuEgn6tZ9xfZwsaDkLmQ/exec',{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});window.location.href='merci.html'}catch(error){console.error('Erreur:',error);alert('Une erreur est survenue. Veuillez réessayer.');submitBtn.disabled=false;submitBtn.classList.remove('loading')}});const inputs=form.querySelectorAll('input, select, textarea');inputs.forEach(input=>{input.addEventListener('input',function(){this.classList.remove('error');const errorMsg=this.parentElement.querySelector('.error-message');if(errorMsg)errorMsg.classList.remove('show')})})});
